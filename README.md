# AI Agent for Financial Moat Analysis

This project is an AI-powered agent that automates the initial phase of investment research by analyzing a company's competitive advantages, or "moat."

## Business Objective

Strategic analysis of a company's competitive advantages, or 'moat,' is a cornerstone of investment research. This process is traditionally manual and time-consuming, requiring analysts to sift through disparate sources like financial reports, news articles, and press releases. This project automates the intelligence-gathering and synthesis phase of this critical task, delivering comprehensive analysis autonomously.

## What is an AI Agent?

Unlike a chatbot, an AI agent is a highly structured system designed to achieve a specific goal. This agent operates a coordinated investment-research workflow. It blends a quantitative signal layer with a reasoning model and a toolkit (market data, web search). The agent's core logic is a Workflow with Personas, where it gathers data through a multi-tiered search strategy and then reasons from multiple distinct investor perspectives including a **Market Investor**, a **Value Investor**, and a **Devil's Advocate** to provide a balanced and nuanced analysis.

A key challenge with Large Language Models is that their knowledge is frozen at the time they were trained. To perform timely financial analysis, an agent needs access to up-to-the-minute information. This is where **Retrieval-Augmented Generation (RAG)** becomes essential. This RAG architecture is crucial for the agent's reliability. It grounds the LLM's powerful reasoning capabilities in real-time, verifiable facts, significantly reducing the risk of generating outdated or inaccurate information.

---

## ðŸ“ˆ Live Portfolio Strategy

<!-- START: PORTFOLIO_THESIS -->
*This section is automatically updated by the AI Portfolio Manager. Last updated: 2025-09-22.*

We maintain a Cautiously Optimistic posture for the upcoming week. While the Federal Reserve's steady interest rate outlook for 2025 provides a stable macroeconomic backdrop, our internal analyst signals indicate a highly selective market, with strong buy opportunities identified in only a limited number of high-potential stocks.
<!-- END: PORTFOLIO_THESIS -->

---

## Project Evolution

**Most Recent Update (September 19, 2025)**:

* New Portfolio Manager Agent: A top-level strategic agent now synthesizes all analysis, forms a dynamic market thesis using live web data, and constructs a weighted portfolio with LLM-driven reasoning.

* Refined Agent Prioritization & Pipeline Stability: Implemented a sophisticated, weighted priority score for agentic analysis (blending quant score, novelty, and staleness). Resolved key data pipeline bugs for improved reliability.

**Update (August 28, 2025)**:

* Cleaner candidate selection: S&P 500â€“only universe, single standardized quantitative source, consistent formatting, and deterministic ranking.

* Unified news intake: Google Custom Search + Yahoo Finance News with full-text fetching, caching, per-domain caps, and a scored evidence budget.

* Clearer scoring: Judge confidence is computed from source diversity, pro/retail mix, full-text hits, recency, and risk flags; fundamentals expanded (FCF, OCF, D/E, P/B, EV/EBITDA, dividend yield) with simple sanity checks on outliers.

**Update (August 14, 2025)**:

* Enhanced candidate generation and agentic recommendation scripts to run on a scheduled weekly GitHub Actions workflow.

* Structured search queries for improved relevance and freshness, reducing LLM hallucinations in analysis.

* Prepared groundwork for upcoming portfolio manager module to track and retain select tickers between runs.

**Update (July 23, 2025)**:

* Added **Streamlit Community Cloud** deployment of agent.

* Switched to **DuckDuckGo search** for initial research on Streamlit application.

**Update (July 21, 2025)**:

* Added a third **"Devil's Advocate"** persona to stress-test the investment thesis and identify key risks.

* Implemented a **final consensus agent** that synthesizes the different persona outputs into a single, actionable rating.

* Integrated **RAG source citations** with publication dates (where available), making the agent's analysis auditable and explainable.

**Initial Commit (July 16, 2025)**: Core RAG pipeline and multi-persona analysis (Market and Value investors).


## Example Analysis

Here are two examples of the agent's output for NVIDIA (NVDA), showcasing the final consensus rating and the detailed, cited analysis from one of the personas.

**Final Consensus Summary**\
This is the high-level summary generated by the "Lead Analyst" persona after synthesizing the reports from the other three agents. Results generated on Google Colab.

> As the Lead Analyst, I have synthesized the diverse perspectives presented in the Market Investor's outlook, the Value Investor's analysis, and the Devil's Advocate's critique.
> 1.  **Consensus Rating:** Neutral with Caution
> 2.  **Summary Justification:**
>     While the Market Investor highlights compelling growth opportunities and positive industry momentum, the Value Investor's analysis raises significant concerns regarding the current valuation, suggesting the stock may be trading at a premium unsupported by its intrinsic fundamentals. Furthermore, the Devil's Advocate effectively underscores material risks, including intensifying competition, potential regulatory headwinds, and execution challenges for key strategic initiatives. Given the promising market dynamics are significantly offset by stretched valuations and identifiable downside risks, a cautious stance is warranted until there is clearer evidence of sustainable competitive advantage or a more attractive entry point.

**Devil's Advocate View, example with Citations**\
This example demonstrates the agent's ability to perform a specific type of analysis and cite its sources.

> --- 4. AI-GENERATED DEVIL'S ADVOCATE VIEW for Nvidia ---
> Despite NVIDIA's extraordinary financial performance and its central role in driving current equity market returns and capital spending, a significant hidden risk lies in the sustainability of its customers' massive AI infrastructure investments. The crucial question for investors is whether hyperscalers and other AI infrastructure users can generate adequate returns on the hundreds of billions in AI-related capital spending, a level of investment that rivals historical periods of over-exuberance like the mainframe or fiber optic eras [4]. For these returns to materialize, a critical shift towards "inference" tasks, where AI runs production models for corporate customers, must occur within the next 12-18 months, rather than GPU capacity primarily being used for foundational model training [4]. Should these customers fail to achieve sufficient profitability from their AI deployments, the demand driving NVIDIA's current growth and its elevated valuation could prove unsustainable.
> Sources Used in this Section:
> 1. Latest News | NVIDIA Newsroom
> 2. The NVIDIA Subreddit
> 3. How is deepseek bearish for nvda : r/wallstreetbets
> 4. EYE ON THE MARKET â€¢ MICHAEL CEMBALEST â€¢ JP MORGAN ...

## Technology Stack (Google Colab Demo)

* **LLM:** Google Gemini 2.5 Flash
* **Agent Framework:** LangChain
* **Embedding Model:** `all-MiniLM-L6-v2` (from Hugging Face)
* **Vector Store:** FAISS (for in-memory semantic search)
* **Data & Tools:**
    * Google Custom Search API
    * Yahoo Finance API (`yfinance`)
    * PDF Parsing (`PyMuPDF`)
    * Google Colab (for development and demonstration)

## How to Run

**The current pipeline runs autonomously using GitHub Actions.**

Custom user queries can be run as per below.


**Demo Application (Streamlit) with user-query use-case:**

The application is deployed and publicly available on Streamlit Community Cloud.

[Click here to try the Live Application!](https://ai-agent-moat.streamlit.app/)


**Running the agent on COLAB with user query use-case:**

1. **Open in Google Colab**:
Click the link below to open the project directly in Google Colab. This is the only step needed to access the application.
[Try the AI Moat Analysis Agent Here](https://colab.research.google.com/github/eriktaylor/ai-agent-moat/blob/main/notebooks/app.ipynb)


3. **Set Up API Keys**:
Once the notebook is open, follow the detailed instructions in Step 1 of the notebook to acquire your free API keys and add them to the Colab Secrets Manager.

4. **Run the Analysis**:
Execute the cells in the notebook. The final cell will prompt you for a company name and stock ticker to begin the analysis.

## Further Reading & Technical Deep Dive
For a more detailed, step-by-step tutorial on the technical implementation, architectural decisions, and code snippets from this project, please see the full write-up on Medium:

[Building a Multi-Tool RAG Agent for Financial Analysis](https://medium.com/digital-mind/building-a-multi-tool-rag-agent-for-financial-analysis-6d4e667546a4)

**Note: This explains the user query use-case, not the complete autonomous workflow.**

## Disclaimer
The content and analysis provided by this AI agent are for informational and educational purposes only and should not be construed as financial advice, investment recommendations, or an offer or solicitation to buy or sell any securities. All investment decisions should be made with the guidance of a qualified financial professional.

# AI Agent for Financial Moat Analysis

This project is an AI-powered agent that automates the initial phase of investment research by analyzing a company's competitive advantages, or "moat." This framework serves as the foundation for a more advanced, private version of the project that operates as a fully autonomous multi-agent system, performing weekly market screening, deep analysis, and portfolio management.

**Project Status: Open-Source Framework**

This public repository contains the open-source (MIT Licensed) framework for the AI Financial Analyst. It is the manually-prompted, query-driven version of the agent, as detailed in the accompanying [Medium article](https://medium.com/digital-mind/building-a-multi-tool-rag-agent-for-financial-analysis-6d4e667546a4).

## Business Objective

Strategic analysis of a company's competitive advantages, or 'moat,' is a cornerstone of investment research. This process is traditionally manual and time-consuming, requiring analysts to sift through disparate sources like financial reports, news articles, and press releases. This project automates the intelligence-gathering and synthesis phase of this critical task, delivering a comprehensive analysis in minutes.

## What is an AI Agent?

Unlike a simple chatbot, the AI agent in this project is a more sophisticated system designed to achieve a complex goal. It operates with a distinct workflow, combining a Reasoning Engine (Google's Gemini 2.5 Flash) with a Set of Tools to access real-world information like financial data, live news, and social media. The agent's core logic is a Workflow with Personas, where it gathers data through a multi-tiered search strategy and then reasons from multiple distinct investor perspectives including a **Market Investor**, a **Value Investor**, and a **Devil's Advocate** to provide a balanced and nuanced analysis.

## The Role of RAG (Retrieval-Augmented Generation)

A key challenge with Large Language Models is that their knowledge is frozen at the time they were trained. To perform timely financial analysis, an agent needs access to up-to-the-minute information. This is where **Retrieval-Augmented Generation (RAG)** becomes essential. The RAG pipeline works as follows:

1.  **Retrieve:** The agent uses its tools to fetch the latest news, financial data, and reports from the internet.
2.  **Augment:** This fresh information is compiled into a dynamic, "on-the-fly" knowledge base for the specific company being analyzed.
3.  **Generate:** The LLM is instructed to base its analysis *only* on this freshly provided context.

This RAG architecture is crucial for the agent's reliability. It grounds the LLM's powerful reasoning capabilities in real-time, verifiable facts, significantly reducing the risk of generating outdated or inaccurate information.


## Live Demo (Streamlit)

The application is deployed and publicly available on Streamlit Community Cloud. This version represents the **most up-to-date and user-friendly implementation** of the agent.

A key difference in this version is its use of **DuckDuckGo for web searches**, which allows the application to run with only a single API key (for Google Gemini). This was a deliberate design choice to make the demo more accessible compared to the Google Colab version, which requires a second key for the Google Custom Search API. Because the search backend is different, the resulting analysis may vary slightly between the two versions.

[Click here to try the Live Application!](https://ai-agent-moat.streamlit.app/)

---

## Project Evolution

**Most Recent Update (December 8, 2025)**:

*RIP Google Gemini Pro 2.5 - Free Tier, it is no more.

**Update (September 23, 2025)**:

* Fixed critical bugs with Yahoo Finance data fetching and key dependencies, significantly improving application stability.

* Improved AI analysis quality by refining prompts for more decisive ratings and fixing text formatting errors.

**Update (July 23, 2025)**:

* Added **Streamlit Community Cloud** deployment of agent.

* Switched to **DuckDuckGo search** for initial research on Streamlit application.

**Update (July 21, 2025)**:

* Added a third **"Devil's Advocate"** persona to stress-test the investment thesis and identify key risks.

* Implemented a **final consensus agent** that synthesizes the different persona outputs into a single, actionable rating.

* Integrated **RAG source citations** with publication dates (where available), making the agent's analysis auditable and explainable.

**Initial Commit (July 16, 2025)**: Core RAG pipeline and multi-persona analysis (Market and Value investors).


## Example Analysis

Here are two examples of the agent's output for NVIDIA (NVDA), showcasing the final consensus rating and the detailed, cited analysis from one of the personas.

**Final Consensus Summary**\
This is the high-level summary generated by the "Lead Analyst" persona after synthesizing the reports from the other three agents. Results generated on Google Colab.

> As the Lead Analyst, I have synthesized the diverse perspectives presented in the Market Investor's outlook, the Value Investor's analysis, and the Devil's Advocate's critique.
> 1.  **Consensus Rating:** Neutral with Caution
> 2.  **Summary Justification:**
>     While the Market Investor highlights compelling growth opportunities and positive industry momentum, the Value Investor's analysis raises significant concerns regarding the current valuation, suggesting the stock may be trading at a premium unsupported by its intrinsic fundamentals. Furthermore, the Devil's Advocate effectively underscores material risks, including intensifying competition, potential regulatory headwinds, and execution challenges for key strategic initiatives. Given the promising market dynamics are significantly offset by stretched valuations and identifiable downside risks, a cautious stance is warranted until there is clearer evidence of sustainable competitive advantage or a more attractive entry point.

**Devil's Advocate View, example with Citations**\
This example demonstrates the agent's ability to perform a specific type of analysis and cite its sources.

> --- 4. AI-GENERATED DEVIL'S ADVOCATE VIEW for Nvidia ---
> Despite NVIDIA's extraordinary financial performance and its central role in driving current equity market returns and capital spending, a significant hidden risk lies in the sustainability of its customers' massive AI infrastructure investments. The crucial question for investors is whether hyperscalers and other AI infrastructure users can generate adequate returns on the hundreds of billions in AI-related capital spending, a level of investment that rivals historical periods of over-exuberance like the mainframe or fiber optic eras [4]. For these returns to materialize, a critical shift towards "inference" tasks, where AI runs production models for corporate customers, must occur within the next 12-18 months, rather than GPU capacity primarily being used for foundational model training [4]. Should these customers fail to achieve sufficient profitability from their AI deployments, the demand driving NVIDIA's current growth and its elevated valuation could prove unsustainable.
> Sources Used in this Section:
> 1. Latest News | NVIDIA Newsroom
> 2. The NVIDIA Subreddit
> 3. How is deepseek bearish for nvda : r/wallstreetbets
> 4. EYE ON THE MARKET • MICHAEL CEMBALEST • JP MORGAN ...


## Technology Stack (Google Colab Demo)

* **LLM:** Google Gemini 2.5 Flash
* **Agent Framework:** LangChain
* **Embedding Model:** `all-MiniLM-L6-v2` (from Hugging Face)
* **Vector Store:** FAISS (for in-memory semantic search)
* **Data & Tools:**
    * Google Custom Search API
    * Yahoo Finance API (`yfinance`)
    * PDF Parsing (`PyMuPDF`)
    * Google Colab (for development and demonstration)

## How to Run

Running the agent is simple and requires no local installation.

1. **Open in Google Colab**:
Click the link below to open the project directly in Google Colab. This is the only step needed to access the application.
[Try the AI Moat Analysis Agent Here](https://colab.research.google.com/github/eriktaylor/ai-agent-moat/blob/main/app.ipynb)

2. **Set Up API Keys**:
Once the notebook is open, follow the detailed instructions in Step 1 of the notebook to acquire your free API keys and add them to the Colab Secrets Manager.

3. **Run the Analysis**:
Execute the cells in the notebook. The final cell will prompt you for a company name and stock ticker to begin the analysis.

## Disclaimer
The content and analysis provided by this AI agent are for informational and educational purposes only and should not be construed as financial advice, investment recommendations, or an offer or solicitation to buy or sell any securities. All investment decisions should be made with the guidance of a qualified financial professional.
